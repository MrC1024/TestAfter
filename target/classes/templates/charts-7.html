<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<!--[if lt IE 9]>
	<script type="text/javascript" src="/static/lib/html5shiv.js"></script>
	<script type="text/javascript" src="/static/lib/respond.min.js"></script>
	<![endif]-->
	<link rel="stylesheet" type="text/css" href="/static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="/static/h-ui.admin/css/H-ui.admin.css" />
	<link rel="stylesheet" type="text/css" href="/static/lib/Hui-iconfont/1.0.8/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="/static/h-ui.admin/skin/default/skin.css" id="skin" />
	<link rel="stylesheet" type="text/css" href="/static/h-ui.admin/css/style.css" />
	<!--[if IE 6]>
	<script type="text/javascript" src="/static/lib/DD_belatedPNG_0.0.8a-min.js" ></script>
	<script>DD_belatedPNG.fix('*');</script>
	<![endif]-->
	<title>角色管理</title>
	<style type="text/css">
		.fade {opacity: 0;
			-webkit-transition: opacity .15s linear;
			-o-transition: opacity .15s linear;
			transition: opacity .15s linear}
		.fade.in {opacity: 1}
		.modal-open {overflow: hidden}
		.modal{ position:fixed; left:0; top:0; right:0; bottom:0; z-index:1040; display:none; overflow:hidden;-webkit-overflow-scrolling:touch; outline:0}
		.modal.fade .modal-dialog{
			-webkit-transition: -webkit-transform .3s ease-out;
			-o-transition: -o-transform .3s ease-out;
			transition: transform .3s ease-out;
			-webkit-transform: translate(0,-50%);
			-ms-transform: translate(0,-50%);
			-o-transform: translate(0,-50%);
			transform: translate(0,-50%)}
		.modal.in .modal-dialog {
			-webkit-transform: translate(0, 0);
			-ms-transform: translate(0, 0);
			-o-transform: translate(0, 0);
			transform: translate(0, 0)}
		.modal-open .modal {overflow-x: hidden;overflow-y: auto}
		.modal-backdrop {position: fixed;top: 0;right: 0;bottom: 0;left: 0;background-color: #000}
		.modal-backdrop.fade {filter: alpha(opacity=0);opacity: 0}
		.modal-backdrop.in {filter: alpha(opacity=50);opacity: .5}
		.modal-dialog {position: relative;width: auto;margin: 10px}
		.modal-content{position: relative;background-color: #fff;border: 1px solid #999;border: 1px solid rgba(0,0,0,.2);outline: 0;
			-webkit-background-clip: padding-box;
			background-clip: padding-box;
			-webkit-box-shadow: 0 3px 9px rgba(0,0,0,.5);
			box-shadow: 0 3px 9px rgba(0,0,0,.5)}

		.modal-header {min-height: 16.42857143px;padding: 15px;border-bottom: 1px solid #eee; position:relative}
		.modal-header .close{position:absolute; right:10px; top:10px}
		.modal-header h3,.modal-header .modal-title{margin:0; padding:10px 0; font-size:16px}

		.modal-body {position:relative;padding: 15px;overflow-y:visible;word-break:break-all}
		.modal-form {margin-bottom: 0}

		.modal-footer {padding:15px;margin-bottom: 0;text-align: right;background-color: #f5f5f5;border-top: 1px solid #eee;*zoom: 1}
		.modal-footer:before,.modal-footer:after {display: table;content: ""}
		.modal-footer:after {clear: both}
		.modal-footer .btn + .btn {margin-left: 5px;margin-bottom: 0}
		.modal-footer .btn-group .btn + .btn {margin-left: -1px}
		.modal-footer .btn-block + .btn-block {margin-left: 0}

		.modal-scrollbar-measure {position: absolute;top: -9999px;width: 50px;height: 50px;overflow: scroll}

		.radius .modal-content{ border-radius:6px}
		.radius .modal-footer{ border-bottom-left-radius:6px; border-bottom-right-radius:6px}
		@media (min-width: 768px) {
			.modal-dialog {width: 600px;margin: 30px auto}
			.modal-content {-webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, .5);box-shadow: 0 5px 15px rgba(0, 0, 0, .5)}
			.modal-sm {width: 300px}
		}
		@media (min-width: 992px) {
			.modal-lg {width: 900px}
		}

		.modal-alert{position:fixed; right:auto; bottom:auto; width:300px; left:50%;margin-left:-150px; top:50%;margin-top:-30px; z-index:9999;background-color: #fff;border: 1px solid #999;border: 1px solid rgba(0,0,0,.2);outline: 0;
			-webkit-background-clip: padding-box;
			background-clip: padding-box;
			-webkit-box-shadow: 0 3px 9px rgba(0,0,0,.5);
			box-shadow: 0 3px 9px rgba(0,0,0,.5)}
		.modal-alert-info{padding:30px; text-align:center; font-size:14px; background-color:#fff}
		.tex{
			width:565px;
			height:200px;
		}
	</style>
</head>
<body>
<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 系统管理 <span class="c-gray en">&gt;</span> 成绩管理 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
<div class="page-container">
	<span class="r">共有数据：<strong id="r">0</strong>条</span> </div>
<table class="table table-border table-bordered table-hover table-bg" id="CJtable">

</table>
</div>
<div id="modal-demo" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content radius">
			<div class="modal-header">
				<h3 class="modal-title">修改系统公告</h3>
				<a class="close" data-dismiss="modal" aria-hidden="true" href="javascript:void();">×</a>
			</div>
			<input type="hidden" id="markid">
			<input type="hidden" id="userid">
			<div class="modal-body">
				名字:<span class="userName" id="userName"></span>
			</div>
			<div class="modal-body">
				所属部门:
				<select id="CJselect">
					<option value = "0">请选择</option>
				</select>
			</div>
			<div class="modal-body">
				试卷类型:
				<select id="SJselect">
					<option value = "0">请选择</option>
				</select>
			</div>
			<div class="modal-body">
				成绩:<input  type="text" class="mscore" id="mscore"/>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" onclick="update()">确定</button>
				<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
			</div>
		</div>
	</div>
</div>
<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="/static/lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="/static/lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="/static/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="/static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="/static/lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
<script type="text/javascript" th:inline="none">
	/*管理员-角色-添加*/
	function admin_role_add(title,url,w,h){
		layer_show(title,url,w,h);
	}
	/*管理员-角色-编辑*/
	function admin_role_edit(title,url,id,w,h){
		layer_show(title,url,w,h);
	}
	/*修改公告模态框*/
	function modaldemo(){
		$("#modal-demo").modal("show")
	}
	function modaldemo1(){
		$("#modal-demo1").modal("show")
	}

	$(function getAll() {
		$.ajax({
			"url":"/Mark/getAll",
			"Type":"post",
			"dateType":"JSON",
			"success":function (result) {
				console.log(result);
				var count= 0;
				$("#CJtable").html("<thead>\n" +
						"\t\t\t<tr>\n" +
						"\t\t\t\t<th scope=\"col\" colspan=\"9\">成绩列表</th>\n" +
						"\t\t\t</tr>\n" +
						"\t\t\t<tr class=\"text-c\">\n" +
						"\t\t\t\t<th width=\"25\"><input type=\"checkbox\" name=\"\" value=\"\"></th>\n" +
						"\t\t\t\t<th width=\"40\">ID</th>\n" +
						"\t\t\t\t<th width=\"150\">名字</th>\n" +
						"\t\t\t\t<th width=\"90\">试卷类型</th>\n" +
						"\t\t\t\t<th width=\"150\">所属部门</th>\n" +
						"\t\t\t\t<th width=\"100\">成绩</th>\n" +
						"\t\t\t\t<th width=\"100\">操作</th>\n" +
						"\t\t\t</tr>\n" +
						"\t\t</thead>");
				$(result).each(function(){
					count++;
					$("#CJtable").append("<tbody>\n" +
							"\t\t\t<tr class=\"text-c\">\n" +
							"\t\t\t\t<td><input type=\"checkbox\" value=\"\" name=\"\"></td>\n" +
							"\t\t\t\t<td>"+this.markid+"</td>\n" +
							"\t\t\t\t<td>"+this.userName+"</td>\n" +
							"\t\t\t\t<td>"+this.testpaperstepName+"</td>\n" +
							"\t\t\t\t<td>"+this.deptName+"</td>\n" +
							"\t\t\t\t<td>"+this.mscore+"分</td>\n" +
							"\t\t\t\t<td class=\"f-14\"><a title=\"编辑\" href=\"javascript:;\" onclick=\"modaldemo();getidAll("+this.markid+")\" style=\"text-decoration:none\"><i class=\"Hui-iconfont\">&#xe6df;</i></a></td>\n" +
							"\t\t\t</tr>\n" +
							"\t\t</tbody>");
				})
				$("#r").text(count);
			}
		})
	})
	$(function deptAll() {
		$.ajax({
			"url":"/Mark/deptAll",
			"Type":"post",
			"dateType":"JSON",
			"success":function (result) {

				var count= 0;
				$("#CJselect").html("<option value = \"0\">请选择</option>");
				$(result).each(function(){
					count++;
					$("#CJselect").append("<option value = "+count+">"+this.deptname+"</option>");
				})
			}
		})
	})
	$(function deptAll() {
		$.ajax({
			"url":"/Mark/testpaperstepAll",
			"Type":"post",
			"dateType":"JSON",
			"success":function (result) {
				var count= 0;
				$("#SJselect").html("<option value = \"0\">请选择</option>");
				var data = JSON.parse(result);
				$(data).each(function(){
					count++;
					$("#SJselect").append("<option value = "+count+">"+this.testpaperstepName+"</option>");
				})
			}
		})
	})
	function getidAll(markid) {
		$.ajax({
			"url": "Mark/getidAll/"+markid,
			"type": "POST",
			"dataType": "JSON",
			"success": function (result) {
				console.log(result);
				$("#userName").text(result.userName);
				$("#CJselect option[value="+result.deptid+"]").attr('selected','selected');
				$("#SJselect option[value="+result.testpaperstepid+"]").attr('selected','selected');
				$("#mscore").val(result.mscore);
				$("#markid").val(result.markid);
				$("#userid").val(result.userId);
			}
		})
	}

	function update() {
		var userid=$("#userid").val();
		var markid=$("#markid").val();
		var mscore=$("#mscore").val();
		var SJselect=$("#SJselect").val();
		var CJselect=$("#CJselect").val();
		$.ajax({
			"url":"Mark/update",
			"data":"userId="+userid+"&markid="+markid+"&mscore="+mscore+"&deptid="+CJselect+"&testpaperstepid="+SJselect,
			"type":"get",
			"dataType":"json",
			"success":function(result){
				if(result>0){
					alert("修改成功 ");
					location.reload();
				}else {
					alert("修改失败");
				}
			}
		})
	}
</script>
</body>
</html>